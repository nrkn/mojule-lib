var mojule=void 0===mojule?{}:mojule;
(function(){var i=mojule.Extensions=function(a){var b={Number:{clamp:function(b,d){return a<b?b:a>d?d:a},wrap:function(b){return(a%b+b)%b},toRadians:function(){return i(a).wrap(360)/180*Math.PI},difference:function(b){return Math.abs(b-a)},step:function(b){return a<b?1:b<a?-1:0},toFixed:function(b){return parseFloat(a.toFixed(b))},almostEquals:function(b,d){return i(a).toFixed(d)===i(b).toFixed(d)},each:function(b){for(var d=0;d<a;d++)b(d,a)}},String:{trim:function(){return String.prototype.trim?a.trim():
a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},inject:function(b){var d=a;i(b).each(function(a,b){for(var c="{"+b+"}";d.match(c);)d=d.replace(c,a)});return d}},Array:{first:function(b){if(!b)return a[0];for(var d=0;d<a.length;d++)if(b(a[d]))return a[d]},any:function(b){if(Array.prototype.some)return a.some(b);if(!b)return!1;i(a).each(function(a){if(b(a))return!0});return!1},all:function(b){if(Array.prototype.every)return a.every(b);if(!b)return!1;i(a).each(function(a){if(!b(a))return!1});return!0},
allOfType:function(b){return i(a).all(function(a){return typeof a===b})},firstDefined:function(){return i(a).first(function(a){return void 0!==a})},anyDefined:function(){return i(a).any(function(a){return void 0!==a})},allDefined:function(){return i(a).all(function(a){return void 0!==a})},elementsEqual:function(b){if(a.length!==b.length)return!1;for(var d=0;d<b.length;d++){if(i(a[d]).elementsEqual)if(i(a[d]).elementsEqual(b[d]))continue;else return!1;if(void 0!==a[d].equals&&"function"===typeof a[d].equals){if(!a[d].equals(b[d]))return!1}else if(a[d]!==
b[d])return!1}return!0},min:function(){return Math.min.apply(Math,a)},max:function(){return Math.max.apply(Math,a)},count:function(b){if(void 0===b)return a.length;var d=0;i(a).each(function(a){b(a)&&d++});return d},each:function(b){for(var d=0;d<a.length;d++)b(a[d],d,a)},chunk:function(b){return[].concat.apply([],a.map(function(d,l){return l%b?[]:[a.slice(l,l+b)]}))}},Arguments:{toValue:function(){return 0===a.length?void 0:1<a.length?Array.prototype.slice.call(a):a[0]},toObject:function(b){return new b(i(a).toValue())}}}[i.getClass(a)];
return void 0!==b?b:{equals:function(b,d){for(var l=0;l<d.length;l++)if(a[d[l]]!==b[d[l]])return!1;return!0},almostEquals:function(b,d){for(var l=0;l<d.length;l++)if(!i(a[d[l]]).almostEquals(b[d[l]],4))return!1;return!0},getPropertyValues:function(b){return b.map(function(b){return a[b]})},each:function(b){for(var d in a)a.hasOwnProperty(d)&&b(a[d],d,a)},injectToString:function(b){return i(b).inject(a)},hasAllProperties:function(b){return i(b).all(function(b){return void 0!==a[b]})}}};void 0===Function.prototype.name&&
void 0!==Object.defineProperty&&Object.defineProperty(Function.prototype,"name",{get:function(){var a=/function\s+(.{1,})\s*\(/.exec(this.toString());return a&&1<a.length?a[1]:""},set:function(){}});i.getClass=function(a){var b=Object.prototype.toString.call(a).match(/^\[object\s(.*)\]$/)[1];return"Object"===b&&"Object"!==a.constructor.name?a.constructor.name:b};i.addMath=function(a,b){i.mixin(Math,a,"abs acos asin atan atan2 ceil cos exp floor log round sin sqrt tan".split(" "),b)};i.mixin=function(a,
b,c,d){for(var l=function(c){b[c]=function(){for(var l=0;l<d.length;l++){var g=d[l];b[g]=a[c].apply(a,[b[g]])}return b}},g=0;g<c.length;g++)l(c[g])};var r=mojule.Extensions;mojule.Mapper=function(a){var b=this,c={undefinedValue:{predicate:function(a){return void 0===a||null===a},map:function(a,b){return b}},toArray:function(){var a=[],b;for(b in this)this.hasOwnProperty(b)&&"function"!==typeof this[b]&&a.push({name:b,predicate:this[b].predicate,map:this[b].map});return a}};this.map=function(a,b){var g=
r(b).toValue(),e=r(c.toArray()).first(function(a){return a.predicate(g)});return!e?void 0:e.map(g,a)};this.hasMapping=function(a){return r(c.toArray()).any(function(b){return b.predicate(a)})};this.getMappingName=function(a){var b=r(c.toArray()).first(function(b){return b.predicate(a)});if(void 0!==b)return b.name};this.addMapping=function(a,b){c[a]=b};this.addMappings=function(a){r(a).each(function(a,d){"function"!==typeof a&&b.addMapping(d,{predicate:a.predicate,map:a.map})})};this.removeMapping=
function(a){void 0!==c[a]&&delete c[a]};void 0!==a&&(a instanceof Array?r(a).each(function(a){b.addMappings(a)}):b.addMappings(a))};var t=function(a){return void 0!==a.value&&0<a.value.length?a.setter():a.getter()},u=function(a,b,c){a.clone=function(){return new b(a)};a.toString=function(){return f(a).getPropertyValues(b.properties).join(",")};a.equals=function(){var d=f(arguments).toObject(b);return f(a).equals(d,b.properties)};a.almostEquals=function(){var d=f(arguments).toObject(b);return f(a).almostEquals(d,
b.properties)};f(b.properties).each(function(b){a[b]=0});b.mapper.map(a,c);f.addMath(a,b.properties)},v=function(a,b){var c={args:{predicate:function(a){return a instanceof Array&&1<a.length&&f(a).allOfType("number")},map:function(b,c){f(a.properties).each(function(a,e){c[a]=b.length>e?parseFloat(b[e]):c[a]});return c}},str:{predicate:function(a){return"string"===typeof a&&0<a.match(y).length},map:function(b,c){var g=b.match(y);f(a.properties).each(function(a,b){c[a]=g.length>b?parseFloat(g[b]):c[a]});
return c}}};f(b).each(function(b,e){var g;if(void 0!==b.aliases){var j=b.aliases;g=function(b){var c=[];f(a.properties).each(function(a){c.push(b[a]);void 0!==j[a]&&c.push(b[j[a]])});return f(c).anyDefined()}}else g=f([b.properties,b.map]).allDefined()?function(a){return void 0!==f(a).hasAllProperties&&f(a).hasAllProperties(b.properties)}:void 0!==b.copy?function(a){return void 0!==f(a).hasAllProperties&&f(a).hasAllProperties(b.copy)}:function(){return!1};var k;if(void 0!==b.aliases){var m=b.aliases;
k=function(b,c){f(a.properties).each(function(a){var d=[b[a]];void 0!==m&&void 0!==m[a]&&d.push(b[m[a]]);d.push(c[a]);c[a]=parseFloat(f(d).firstDefined())});return c}}else k=f([b.properties,b.map]).allDefined()?function(a,c){b.map(a,c);return c}:void 0!==b.copy?function(a,c){f(b.copy).each(function(b){c[b]=a[b]});return c}:function(a,b){return b};c[e]={predicate:g,map:k}});return c},z=function(a,b,c,d,e){var g=Math.min(b,d),f=Math.min(c,e);a.left=g;a.top=f;a.width=Math.max(b,d)-g;a.height=Math.max(c,
e)-f},f=mojule.Extensions,y=/[+\-]?(?:\d+\.?\d*|\d*\.?\d+)/g;mojule.Point=function(){var a=this;u(a,mojule.Point,arguments);this.unitVector=function(){return new Point(a.x/a.length(),a.y/a.length())};this.length=function(){return t({value:arguments,setter:function(){var b=a.unitVector(),c=f(this.value).toValue();a.x=b.x*c;a.y=b.y*c;return a},getter:function(){return Math.sqrt(a.x*a.x+a.y*a.y)}})};this.scale=function(b){a.x*=b;a.y*=b;return a};this.translate=function(){var b=f(arguments).toObject(mojule.Point);
a.x+=b.x;a.y+=b.y;return a};this.rotate=function(){if(1>arguments.length)return a;var b=arguments[0],c=1<arguments.length?f(arguments).toValue().slice(1):void 0,d=f(parseFloat(b)).toRadians();void 0!==c&&(c=new mojule.Point(c),a.translate(new mojule.Point(-1*c.x,-1*c.y)));b=a.x*Math.cos(d)-a.y*Math.sin(d);d=a.x*Math.sin(d)+a.y*Math.cos(d);a.x=b;a.y=d;void 0!==c&&a.translate(c);return a};this.lineTo=function(){var b=f(arguments).toObject(mojule.Point);return new mojule.Line(a,b)};this.lineFrom=function(){var b=
f(arguments).toObject(mojule.Point);return new mojule.Line(b,a)};this.neighbours=function(){return[new mojule.Point(a.x,a.y-1),new mojule.Point(a.x,a.y+1),new mojule.Point(a.x-1,a.y),new mojule.Point(a.x+1,a.y)]};this.wrap=function(){var b=new mojule.Size(arguments);a.x=f(a.x).wrap(b.width);a.y=f(a.y).wrap(b.height);return a}};mojule.Point.properties=["x","y"];mojule.Point.mapper=new mojule.Mapper(v(mojule.Point,{line:{properties:["x1","y1","x2","y2"],map:function(a,b){b.x=Math.max(a.x1,a.x2)-Math.min(a.x1,
a.x2);b.y=Math.max(a.y1,a.y2)-Math.min(a.y1,a.y2)}},rectangleOrSize:{aliases:{x:"width",y:"height"}},rectangle2:{properties:["left","top","right","bottom"],map:function(a,b){b.x=Math.max(a.left,a.right)-Math.min(a.left,a.right);b.y=Math.max(a.top,a.bottom)-Math.min(a.top,a.bottom)}},leftTop:{aliases:{x:"left",y:"top"}}}));mojule.Line=function(){var a=this;u(a,mojule.Line,arguments);this.start=function(){return t({value:arguments,setter:function(){var b=f(this.value).toObject(mojule.Point);a.x1=b.x;
a.y1=b.y;return a},getter:function(){return new mojule.Point(a.x1,a.y1)}})};this.end=function(){return t({value:arguments,setter:function(){var b=f(this.value).toObject(mojule.Point);a.x2=b.x;a.y2=b.y;return a},getter:function(){return new mojule.Point(a.x2,a.y2)}})};this.verticals=function(){return[a.x1,a.x2]};this.horizontals=function(){return[a.y1,a.y2]};this.points=function(){return[a.start(),a.end()]};this.bresenham=function(){for(var b=a.clone().round(),c=f(b.end().x).difference(b.start().x),
d=f(b.end().y).difference(b.start().y),e=f(b.start().x).step(b.end().x),g=f(b.start().y).step(b.end().y),j=c-d,k=b.start(),m=[];;){m.push(k.clone());if(k.equals(b.end()))break;var h=2*j;h>-d&&(j-=d,k.x+=e);h>=c||(j+=c,k.y+=g)}return m};this.rotate=function(){a.start(a.start.rotate(arguments));a.end(a.end.rotate(arguments));return a};this.translate=function(){var b=f(arguments).toObject(mojule.Point);a.start(a.start().translate(b));a.end(a.end().translate(b));return a}};mojule.Line.properties=["x1",
"y1","x2","y2"];mojule.Line.mapper=new mojule.Mapper([v(mojule.Line,{point:{aliases:{x2:"x",y2:"y"}},sizeOrRectangle:{properties:["width","height"],map:function(a,b){var c=void 0!==a.x?a.x:0,d=void 0!==a.y?a.y:0;b.x1=c;b.y1=d;b.x2=c+a.width;b.y2=d+a.height}}}),{points:{predicate:function(a){return a instanceof Array&&1<a.length&&f([a[0].x,a[0].y]).anyDefined()&&f([a[1].x,a[1].y]).anyDefined()},map:function(a,b){b.x1=parseFloat(a[0].x);b.y1=parseFloat(a[0].y);b.x2=parseFloat(a[1].x);b.y2=parseFloat(a[1].y);
return b}}}]);mojule.Size=function(){u(this,mojule.Size,arguments)};mojule.Size.properties=["width","height"];mojule.Size.mapper=new mojule.Mapper([v(mojule.Size,{point:{aliases:{width:"x",height:"y"}},line:{properties:["x1","y1","x2","y2"],map:function(a,b){b.width=Math.max(a.x1,a.x2)-Math.min(a.x1,a.x2);b.height=Math.max(a.y1,a.y2)-Math.min(a.y1,a.y2)}},rectangle:{copy:["width","height"]},rectangle2:{properties:["left","right","top","bottom"],map:function(a,b){b.width=Math.max(a.left,a.right)-Math.min(a.left,
a.right);b.height=Math.max(a.top,a.bottom)-Math.min(a.top,a.bottom)}}})]);mojule.Rectangle=function(){var a=this;u(a,mojule.Rectangle,arguments);this.right=function(){return a.left+a.width};this.bottom=function(){return a.top+a.height};this.inBounds=function(){var b=new mojule.Point(f(arguments).toValue());return b.x>=a.left&&b.x<=a.right()&&b.y>=top&&b.y<=a.bottom()}};mojule.Rectangle.properties=["left","top","width","height"];mojule.Rectangle.mapper=new mojule.Mapper([v(mojule.Rectangle,{rectangle3:{properties:["x",
"y","width","height"],map:function(a,b){b.width=a.width;b.height=a.height}},point:{aliases:{left:"x",top:"y"}},line:{properties:["x1","y1","x2","y2"],map:function(a,b){z(b,a.x1,a.y1,a.x2,a.y2)}},size:{copy:["width","height"]},rectangle2:{properties:["left","right","top","bottom"],map:function(a,b){z(b,a.left,a.top,a.right,a.bottom)}}})]);mojule.Grid=function(){function a(a,f,h){c[f*g.width+a]=h;void 0===d[f]&&(d[f]=[]);d[f][a]=h;void 0===e[a]&&(e[a]=[]);e[a][f]=h;return b}var b=this,c=[],d=[],e=[],
g=new mojule.Size;this.get=function(){if(1<arguments.length&&"number"===typeof arguments[0]&&"number"===typeof arguments[1])return c[arguments[1]*g.width+arguments[0]];if(1===arguments.length&&void 0!==arguments[0].x&&void 0!==arguments[0].y)return c[arguments[0].y*g.width+arguments[0].x];var a=new mojule.Point(arguments);return c[a.y*g.width+a.x]};this.set=function(){if(!(2>arguments.length)){var b=arguments[0];if(2<arguments.length&&"number"===typeof arguments[1]&&"number"===typeof arguments[2])return a(b,
arguments[1],arguments[2]);if(2===arguments.length&&void 0!==arguments[1].x&&void 0!==arguments[1].y)return a(b,arguments[1].x,arguments[1].y);var c=new mojule.Point(f(arguments).toValue().slice(1));return a(b,c.x,c.y)}};this.each=function(a){for(var d=0;d<g.height;d++)for(var e=0;e<g.width;e++)a(c[d*g.width+e],e,d,g.width,g.height);return b};this.setEach=function(d){for(var e=0;e<g.height;e++)for(var f=0;f<g.width;f++)a(f,e,d(f,e,c[e*g.width+f],g.width,g.height));return b};this.cells=function(){return t({value:arguments,
setter:function(){c=f(this.value).toValue();e=[];for(var a=0;a<g.width;a++){for(var j=[],h=0;h<g.height;h++)j.push(c[h*g.width+a]);e.push(j)}d=f(b.cells()).chunk(g.width);return b},getter:function(){return c.slice(0)}})};this.size=function(){return g.clone()};this.clone=function(){var a=new Grid(g);a.cells(b.cells());return a};this.toString=function(a){return void 0!==a&&a instanceof Function?g.toString()+","+c.map(a).join(","):g.toString()+","+JSON.stringify(c)};this.equals=function(a){return g.equals(a.size())&&
f(c).elementsEqual(a.cells())};this.bounds=function(){return new Rectangle(g)};this.rows=function(){return d.slice(0)};this.columns=function(){return e.slice(0)};var j=f(arguments).toValue();null!==j&&f([j.width,j.height,j.data]).allDefined()?(g=new mojule.Size(j.width,j.height),c=f(j.data).chunk(4)):(mojule.Size.mapper.map(g,arguments),g.ceil().abs())};var n=function(a){return void 0!==a.value?a.setter():a.getter()},p=function(a){return 0.299*a.red+0.587*a.green+0.114*a.blue},A=function(a){var b=
a.red/255,c=a.green/255,a=a.blue/255,d=Math.max(b,c,a),e=Math.min(b,c,a),g,f=(d+e)/2,k=d-e;if(d===e)g=e=0;else{e=0.5<f?k/(2-d-e):k/(d+e);switch(d){case b:g=(c-a)/k+(c<a?6:0);break;case c:g=(a-b)/k+2;break;case a:g=(b-c)/k+4}g/=6}return{hue:360*g,saturation:100*e,lightness:100*f}},B=function(a){"#"===a.substr(0,1)&&(a=a.substr(1));return 3===a.length?{red:parseInt(a.substr(0,1)+a.substr(0,1),16),green:parseInt(a.substr(1,1)+a.substr(1,1),16),blue:parseInt(a.substr(2,1)+a.substr(2,1),16)}:{red:parseInt(a.substr(0,
2),16),green:parseInt(a.substr(2,2),16),blue:parseInt(a.substr(4,2),16)}},x=function(a){a=a.toString(16);return 2>a.length?"0"+a:a},C=function(a,b){return{hue:e(a.hue*e([b.hue,b.h,1]).firstDefined()).wrap(360),saturation:e(a.saturation*e([b.saturation,b.s,1]).firstDefined()).clamp(0,100),lightness:e(a.lightness*e([b.lightness,b.l,1]).firstDefined()).clamp(0,100),alpha:e(a.alpha*e([b.alpha,b.a,1]).firstDefined()).clamp(0,1)}},D=function(a,b){return{hue:e(a.hue+e([b.hue,b.h,0]).firstDefined()).wrap(360),
saturation:e(a.saturation+e([b.saturation,b.s,0]).firstDefined()).clamp(0,100),lightness:e(a.lightness+e([b.lightness,b.l,0]).firstDefined()).clamp(0,100),alpha:e(a.alpha+e([b.alpha,b.a,0]).firstDefined()).clamp(0,1)}},e=mojule.Extensions;mojule.Color=function(){function a(){return{red:Math.round(c),green:Math.round(d),blue:Math.round(f),alpha:m,css:"rgba( "+Math.round(c)+", "+Math.round(d)+", "+Math.round(f)+", "+m+" )"}}function b(){return{hue:g,saturation:j,lightness:k,alpha:m,css:"hsla( "+g+", "+
j+"%, "+k+"%, "+m+" )"}}var c=0,d=0,f=0,g=360,j=0,k=0,m=1,h=this;this.red=function(a){return n({value:a,setter:function(){return h.rgba({red:this.value})},getter:function(){return c}})};this.green=function(a){return n({value:a,setter:function(){return h.rgba({green:this.value})},getter:function(){return d}})};this.blue=function(a){return n({value:a,setter:function(){return h.rgba({blue:this.value})},getter:function(){return f}})};this.hue=function(a){return n({value:a,setter:function(){return h.hsla({hue:this.value})},
getter:function(){return g}})};this.saturation=function(a){return n({value:a,setter:function(){return h.hsla({saturation:this.value})},getter:function(){return j}})};this.lightness=function(a){return n({value:a,setter:function(){return h.hsla({lightness:this.value})},getter:function(){return k}})};this.alpha=function(a){return n({value:a,setter:function(){return h.hsla({alpha:this.value})},getter:function(){return m}})};this.rgb=this.rgba=function(b){return n({value:b,setter:function(){c=e(e([this.value.red,
this.value.r,c,0]).firstDefined()).clamp(0,255);d=e(e([this.value.green,this.value.g,d,0]).firstDefined()).clamp(0,255);f=e(e([this.value.blue,this.value.b,f,0]).firstDefined()).clamp(0,255);m=e(e([this.value.alpha,this.value.a,m,1]).firstDefined()).clamp(0,1);var b=A(a());g=b.hue;j=b.saturation;k=b.lightness;return h},getter:a})};this.hsl=this.hsla=function(a){return n({value:a,setter:function(){g=e(e([this.value.hue,this.value.h,g,360]).firstDefined()).wrap(360);j=e(e([this.value.saturation,this.value.s,
j,0]).firstDefined()).clamp(0,100);k=e(e([this.value.lightness,this.value.l,k,0]).firstDefined()).clamp(0,100);m=e(e([this.value.alpha,this.value.a,m,1]).firstDefined()).clamp(0,1);var a=b(),s=a.hue/360,i=a.saturation/100,q=a.lightness/100,a=function(a,b,c){0>c&&(c+=1);1<c&&(c-=1);return c<1/6?a+6*(b-a)*c:0.5>c?b:c<2/3?a+6*(b-a)*(2/3-c):a},n=0.5>q?q*(1+i):q+i-q*i,p=2*q-n;0===i?i=q=s=q:(i=a(p,n,s+1/3),q=a(p,n,s),s=a(p,n,s-1/3));c=255*i;d=255*q;f=255*s;return h},getter:b})};this.bytes=function(b){return n({value:b,
setter:function(){if(b instanceof Array){c=e(e([this.value[0],c]).firstDefined()).clamp(0,255);d=e(e([this.value[1],d]).firstDefined()).clamp(0,255);f=e(e([this.value[2],f]).firstDefined()).clamp(0,255);void 0!==this.value[3]&&(m=parseFloat((this.value[3]/255).toFixed(2)));var w=A(a());g=w.hue;j=w.saturation;k=w.lightness}return h},getter:function(){return[c,d,f,Math.round(255*m)]}})};this.toString=this.css=function(){return 1===parseFloat(m)?h.hex():a().css};this.hex=function(b){return n({value:b,
setter:function(){return h.rgba(B(this.value))},getter:function(){var b=a(),c=x(Math.round(b.red)),d=x(Math.round(b.green)),b=x(Math.round(b.blue));return"#"+(c.charAt(0)===c.charAt(1)&&d.charAt(0)===d.charAt(1)&&b.charAt(0)===b.charAt(1)?c.charAt(0)+d.charAt(0)+b.charAt(0):c+d+b)}})};this.brightness=function(){return p(a())};this.brightnessDifference=function(a){var b=h.rgba(),a=(new mojule.Color(a)).rgba();return Math.abs(p(b)-p(a))};this.colorDifference=function(a){var b=h.rgba(),c=(new mojule.Color(a)).rgba(),
a=Math.max(b.red,c.red),d=Math.min(b.red,c.red),e=Math.max(b.green,c.green),f=Math.min(b.green,c.green),g=Math.max(b.blue,c.blue),b=Math.min(b.blue,c.blue);return a-d+(e-f)+(g-b)};this.hasEnoughContrast=function(a,b,c){c=void 0!==c?c:125;return h.colorDifference(a)>=(void 0!==b?b:500)&&h.brightnessDifference(a)>=c};this.multiplyHsla=function(a){return h.hsla(C(h.hsla(),a))};this.sumHsla=function(a){return h.hsla(D(h.hsla(),a))};this.clone=function(){return new mojule.Color(h.hsla())};this.getContrastingTone=
function(){var a=mojule.Color,b;b=h.rgba();var c={red:255,green:255,blue:255},d={red:0,green:0,blue:0},e=Math.abs(p(b)-p(c));b=Math.abs(p(b)-p(d))-30>e?d:c;return new a(b)};this.equals=function(){var a=new mojule.Color(e(arguments).toValue());return e([this.red(),this.green(),this.blue(),this.alpha()]).elementsEqual([a.red(),a.green(),a.blue(),a.alpha()])};mojule.Color.mapper.map(h,arguments)};mojule.Color.regexes={cssHex:/^#(?:[0-9a-f]{3,6})\b$/i,cssRgb:/^rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i,
cssRgbPercent:/^rgb\s*\(\s*([0-9]+|[0-9]*\.[0-9])%\s*,\s*([0-9]+|[0-9]*\.[0-9])%\s*,\s*([0-9]+|[0-9]*\.[0-9])%\s*\)$/i,cssRgba:/^rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([0-9]+|[0-9]*\.[0-9])\s*\)$/i,cssRgbaPercent:/^rgba\s*\(\s*([0-9]+|[0-9]*\.[0-9])%\s*,\s*([0-9]+|[0-9]*\.[0-9])%\s*,\s*([0-9]+|[0-9]*\.[0-9])%\s*,\s*([0-9]+|[0-9]*\.[0-9])\s*\)$/i,cssHsl:/^hsl\s*\(\s*(\d+)\s*,\s*([0-9]+|[0-9]*\.[0-9])%\s*,\s*([0-9]+|[0-9]*\.[0-9])%\s*\)$/i,cssHsla:/^hsla\s*\(\s*(\d+)\s*,\s*([0-9]+|[0-9]*\.[0-9])%\s*,\s*([0-9]+|[0-9]*\.[0-9])%\s*,\s*([0-9]+|[0-9]*\.[0-9])\s*\)$/i};
mojule.Color.mapper=new mojule.Mapper({cssHex:{predicate:function(a){return"string"===typeof a&&mojule.Color.regexes.cssHex.test(e(a).trim())},map:function(a,b){return b.hex(a)}},cssRgb:{predicate:function(a){return"string"===typeof a&&mojule.Color.regexes.cssRgb.test(e(a).trim())},map:function(a,b){var c=e(a).trim().match(mojule.Color.regexes.cssRgb);return b.rgba({red:parseInt(c[1],10),green:parseInt(c[2],10),blue:parseInt(c[3],10)})}},cssRgbPercent:{predicate:function(a){return"string"===typeof a&&
mojule.Color.regexes.cssRgbPercent.test(e(a).trim())},map:function(a,b){var c=e(a).trim().match(mojule.Color.regexes.cssRgbPercent);return b.rgba({red:2.55*parseInt(c[1],10),green:2.55*parseInt(c[2],10),blue:2.55*parseInt(c[3],10),alpha:1})}},cssRgba:{predicate:function(a){return"string"===typeof a&&mojule.Color.regexes.cssRgba.test(e(a).trim())},map:function(a,b){var c=e(a).trim().match(mojule.Color.regexes.cssRgba);return b.rgba({red:parseInt(c[1],10),green:parseInt(c[2],10),blue:parseInt(c[3],
10),alpha:parseFloat(c[4])})}},cssRgbaPercent:{predicate:function(a){return"string"===typeof a&&mojule.Color.regexes.cssRgbaPercent.test(e(a).trim())},map:function(a,b){var c=e(a).trim().match(mojule.Color.regexes.cssRgbaPercent);return b.rgba({red:2.55*parseInt(c[1],10),green:2.55*parseInt(c[2],10),blue:2.55*parseInt(c[3],10),alpha:parseFloat(c[4])})}},cssHsl:{predicate:function(a){return"string"===typeof a&&mojule.Color.regexes.cssHsl.test(e(a).trim())},map:function(a,b){var c=e(a).trim().match(mojule.Color.regexes.cssHsl);
return b.hsla({hue:parseInt(c[1],10),saturation:parseInt(c[2],10),lightness:parseInt(c[3],10),alpha:1})}},cssHsla:{predicate:function(a){return"string"===typeof a&&mojule.Color.regexes.cssHsla.test(e(a).trim())},map:function(a,b){var c=e(a).trim().match(mojule.Color.regexes.cssHsla);return b.hsla({hue:parseInt(c[1],10),saturation:parseInt(c[2],10),lightness:parseInt(c[3],10),alpha:parseFloat(c[4])})}},cssNamedColor:{predicate:function(a){return"string"===typeof a&&void 0!==mojule.Color.namedColors[e(a).trim()]},
map:function(a,b){return b.rgba(mojule.Color.namedColors[e(a).trim()].rgba())}},color:{predicate:function(a){return"function"===typeof a.rgba},map:function(a,b){return b.rgba(a.rgba())}},rgba:{predicate:function(a){return e([a.red,a.green,a.blue,a.r,a.g,a.b]).anyDefined()},map:function(a,b){return b.rgba(a)}},hsla:{predicate:function(a){return e([a.hue,a.saturation,a.lightness,a.h,a.s,a.l]).anyDefined()},map:function(a,b){return b.hsla(a)}},greyscale:{predicate:function(a){return"number"===typeof a},
map:function(a,b){return b.rgb({red:a,green:a,blue:a})}},greyscaleAlpha:{predicate:function(a){return a instanceof Array&&2===a.length&&e(a).allOfType("number")},map:function(a,b){return b.rgba({red:a[0],green:a[0],blue:a[0],alpha:a[1]})}},rgbNumbers:{predicate:function(a){return a instanceof Array&&3===a.length&&e(a).allOfType("number")},map:function(a,b){return b.rgb({red:a[0],green:a[1],blue:a[2]})}},rgbaNumbers:{predicate:function(a){return a instanceof Array&&4===a.length&&e(a).allOfType("number")},
map:function(a,b){return b.rgb({red:a[0],green:a[1],blue:a[2],alpha:a[3]})}},imageData:{predicate:function(a){return a instanceof Array&&3===a.length&&e(a.slice(1)).allOfType("number")?e([a[0].width,a[0].height,a[0].data]).allDefined():!1},map:function(a,b){var c=a[0],d=4*(a[2]*c.width+a[1]),e=c.data[d+3];return b.rgb({red:c.data[d],green:c.data[d+1],blue:c.data[d+2],alpha:0===e?0:255/e})}}});mojule.Color.range=function(a,b,c){var a=new mojule.Color(a),d=new mojule.Color(b),f=a.hsla(),g,i=[],k=mojule.Color.mapper.getMappingName(b);
"rgba"===k?d=a.clone().rgba(b):"hsla"===k&&(d=a.clone().hsla(b));g=d.hsla();c=void 0===c||2>c?2:c;e(c).each(function(a){i.push(new mojule.Color({hue:f.hue+(g.hue-f.hue)/(c-1)*a,saturation:f.saturation+(g.saturation-f.saturation)/(c-1)*a,lightness:f.lightness+(g.lightness-f.lightness)/(c-1)*a,alpha:f.alpha+(g.alpha-f.alpha)/(c-1)*a}))});return i};mojule.Color.namedColors={aliceblue:new mojule.Color("#f0f8ff"),antiquewhite:new mojule.Color("#faebd7"),aqua:new mojule.Color("#00ffff"),aquamarine:new mojule.Color("#7fffd4"),
azure:new mojule.Color("#f0ffff"),beige:new mojule.Color("#f5f5dc"),bisque:new mojule.Color("#ffe4c4"),black:new mojule.Color("#000000"),blanchedalmond:new mojule.Color("#ffebcd"),blue:new mojule.Color("#0000ff"),blueviolet:new mojule.Color("#8a2be2"),brown:new mojule.Color("#a52a2a"),burlywood:new mojule.Color("#deb887"),cadetblue:new mojule.Color("#5f9ea0"),chartreuse:new mojule.Color("#7fff00"),chocolate:new mojule.Color("#d2691e"),coral:new mojule.Color("#ff7f50"),cornflowerblue:new mojule.Color("#6495ed"),
cornsilk:new mojule.Color("#fff8dc"),crimson:new mojule.Color("#dc143c"),cyan:new mojule.Color("#00ffff"),darkblue:new mojule.Color("#00008b"),darkcyan:new mojule.Color("#008b8b"),darkgoldenrod:new mojule.Color("#b8860b"),darkgray:new mojule.Color("#a9a9a9"),darkgreen:new mojule.Color("#006400"),darkgrey:new mojule.Color("#a9a9a9"),darkkhaki:new mojule.Color("#bdb76b"),darkmagenta:new mojule.Color("#8b008b"),darkolivegreen:new mojule.Color("#556b2f"),darkorange:new mojule.Color("#ff8c00"),darkorchid:new mojule.Color("#9932cc"),
darkred:new mojule.Color("#8b0000"),darksalmon:new mojule.Color("#e9967a"),darkseagreen:new mojule.Color("#8fbc8f"),darkslateblue:new mojule.Color("#483d8b"),darkslategray:new mojule.Color("#2f4f4f"),darkslategrey:new mojule.Color("#2f4f4f"),darkturquoise:new mojule.Color("#00ced1"),darkviolet:new mojule.Color("#9400d3"),deeppink:new mojule.Color("#ff1493"),deepskyblue:new mojule.Color("#00bfff"),dimgray:new mojule.Color("#696969"),dimgrey:new mojule.Color("#696969"),dodgerblue:new mojule.Color("#1e90ff"),
firebrick:new mojule.Color("#b22222"),floralwhite:new mojule.Color("#fffaf0"),forestgreen:new mojule.Color("#228b22"),fuchsia:new mojule.Color("#ff00ff"),gainsboro:new mojule.Color("#dcdcdc"),ghostwhite:new mojule.Color("#f8f8ff"),gold:new mojule.Color("#ffd700"),goldenrod:new mojule.Color("#daa520"),gray:new mojule.Color("#808080"),green:new mojule.Color("#008000"),greenyellow:new mojule.Color("#adff2f"),grey:new mojule.Color("#808080"),honeydew:new mojule.Color("#f0fff0"),hotpink:new mojule.Color("#ff69b4"),
indianred:new mojule.Color("#cd5c5c"),indigo:new mojule.Color("#4b0082"),ivory:new mojule.Color("#fffff0"),khaki:new mojule.Color("#f0e68c"),lavender:new mojule.Color("#e6e6fa"),lavenderblush:new mojule.Color("#fff0f5"),lawngreen:new mojule.Color("#7cfc00"),lemonchiffon:new mojule.Color("#fffacd"),lightblue:new mojule.Color("#add8e6"),lightcoral:new mojule.Color("#f08080"),lightcyan:new mojule.Color("#e0ffff"),lightgoldenrodyellow:new mojule.Color("#fafad2"),lightgray:new mojule.Color("#d3d3d3"),
lightgreen:new mojule.Color("#90ee90"),lightgrey:new mojule.Color("#d3d3d3"),lightpink:new mojule.Color("#ffb6c1"),lightsalmon:new mojule.Color("#ffa07a"),lightseagreen:new mojule.Color("#20b2aa"),lightskyblue:new mojule.Color("#87cefa"),lightslategray:new mojule.Color("#778899"),lightslategrey:new mojule.Color("#778899"),lightsteelblue:new mojule.Color("#b0c4de"),lightyellow:new mojule.Color("#ffffe0"),lime:new mojule.Color("#00ff00"),limegreen:new mojule.Color("#32cd32"),linen:new mojule.Color("#faf0e6"),
magenta:new mojule.Color("#ff00ff"),maroon:new mojule.Color("#800000"),mediumaquamarine:new mojule.Color("#66cdaa"),mediumblue:new mojule.Color("#0000cd"),mediumorchid:new mojule.Color("#ba55d3"),mediumpurple:new mojule.Color("#9370db"),mediumseagreen:new mojule.Color("#3cb371"),mediumslateblue:new mojule.Color("#7b68ee"),mediumspringgreen:new mojule.Color("#00fa9a"),mediumturquoise:new mojule.Color("#48d1cc"),mediumvioletred:new mojule.Color("#c71585"),midnightblue:new mojule.Color("#191970"),mintcream:new mojule.Color("#f5fffa"),
mistyrose:new mojule.Color("#ffe4e1"),moccasin:new mojule.Color("#ffe4b5"),navajowhite:new mojule.Color("#ffdead"),navy:new mojule.Color("#000080"),oldlace:new mojule.Color("#fdf5e6"),olive:new mojule.Color("#808000"),olivedrab:new mojule.Color("#6b8e23"),orange:new mojule.Color("#ffa500"),orangered:new mojule.Color("#ff4500"),orchid:new mojule.Color("#da70d6"),palegoldenrod:new mojule.Color("#eee8aa"),palegreen:new mojule.Color("#98fb98"),paleturquoise:new mojule.Color("#afeeee"),palevioletred:new mojule.Color("#db7093"),
papayawhip:new mojule.Color("#ffefd5"),peachpuff:new mojule.Color("#ffdab9"),peru:new mojule.Color("#cd853f"),pink:new mojule.Color("#ffc0cb"),plum:new mojule.Color("#dda0dd"),powderblue:new mojule.Color("#b0e0e6"),purple:new mojule.Color("#800080"),red:new mojule.Color("#ff0000"),rosybrown:new mojule.Color("#bc8f8f"),royalblue:new mojule.Color("#4169e1"),saddlebrown:new mojule.Color("#8b4513"),salmon:new mojule.Color("#fa8072"),sandybrown:new mojule.Color("#f4a460"),seagreen:new mojule.Color("#2e8b57"),
seashell:new mojule.Color("#fff5ee"),sienna:new mojule.Color("#a0522d"),silver:new mojule.Color("#c0c0c0"),skyblue:new mojule.Color("#87ceeb"),slateblue:new mojule.Color("#6a5acd"),slategray:new mojule.Color("#708090"),slategrey:new mojule.Color("#708090"),snow:new mojule.Color("#fffafa"),springgreen:new mojule.Color("#00ff7f"),steelblue:new mojule.Color("#4682b4"),tan:new mojule.Color("#d2b48c"),teal:new mojule.Color("#008080"),thistle:new mojule.Color("#d8bfd8"),tomato:new mojule.Color("#ff6347"),
turquoise:new mojule.Color("#40e0d0"),transparent:new mojule.Color({alpha:0}),violet:new mojule.Color("#ee82ee"),wheat:new mojule.Color("#f5deb3"),white:new mojule.Color("#ffffff"),whitesmoke:new mojule.Color("#f5f5f5"),yellow:new mojule.Color("#ffff00"),yellowgreen:new mojule.Color("#9acd32")}})();
var Extensions=void 0===Extensions?mojule.Extensions:Extensions,Mapper=void 0===Mapper?mojule.Mapper:Mapper,Point=void 0===Point?mojule.Point:Point,Line=void 0===Line?mojule.Line:Line,Size=void 0===Size?mojule.Size:Size,Rectangle=void 0===Rectangle?mojule.Rectangle:Rectangle,Grid=void 0===Grid?mojule.Grid:Grid,Color=void 0===Color?mojule.Color:Color;